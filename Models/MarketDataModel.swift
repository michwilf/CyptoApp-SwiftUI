//
//  MarketDataModel.swift
//  CryptoApp
//
//  Created by MikeyW on 19/05/2022.
//

import Foundation

// JSON DATA
/*
 URL: https://api.coingecko.com/api/v3/global
 
 JSON Response: {
 "data": {
   "active_cryptocurrencies": 13424,
   "upcoming_icos": 0,
   "ongoing_icos": 49,
   "ended_icos": 3376,
   "markets": 808,
   "total_market_cap": {
     "btc": 44374111.252242304,
     "eth": 664654153.1968822,
     "ltc": 18720551822.016163,
     "bch": 6839581590.424206,
     "bnb": 4380360654.070409,
     "eos": 1015582158683.2316,
     "xrp": 3199294098665.46,
     "xlm": 10142329447994.783,
     "link": 187008820969.95862,
     "dot": 132297649421.8403,
     "yfi": 139556820.44290265,
     "usd": 1339706798204.9993,
     "aed": 4920743069806.939,
     "ars": 158554200429258.3,
     "aud": 1899764526660.6062,
     "bdt": 117358209685920.53,
     "bhd": 505123051195.2105,
     "bmd": 1339706798204.9993,
     "brl": 6571931698594.623,
     "cad": 1718106983357.9995,
     "chf": 1302022185678.289,
     "clp": 1124281945053633.9,
     "cny": 8993853648389.602,
     "czk": 31259914605236.477,
     "dkk": 9418034294250.89,
     "eur": 1265453548914.4834,
     "gbp": 1072458066978.6676,
     "hkd": 10513965364040.908,
     "huf": 486481601813287.2,
     "idr": 19605470240951676,
     "ils": 4526688410716.919,
     "inr": 103734676326995.16,
     "jpy": 170863823339113.78,
     "krw": 1695862446130571.2,
     "kwd": 410385684960.1458,
     "lkr": 482569657962527.1,
     "mmk": 2481854845369336.5,
     "mxn": 26696226172166.742,
     "myr": 5888681231510.079,
     "ngn": 556139086070857.4,
     "nok": 13000970270092.678,
     "nzd": 2096588890625.6892,
     "php": 69969539482665.234,
     "pkr": 264994004684948.3,
     "pln": 5887621523432.686,
     "rub": 83229283498778.66,
     "sar": 5025332639836.031,
     "sek": 13281996546031.758,
     "sgd": 1848761888852.9429,
     "thb": 46096430556617.695,
     "try": 21250295262447.84,
     "twd": 39804831165840.805,
     "uah": 39603354000165.53,
     "vef": 134144841704.26631,
     "vnd": 31000815310463616,
     "zar": 21248975651251.637,
     "xdr": 977065584119.2831,
     "xag": 61377019120.39995,
     "xau": 727219644.2016349,
     "bits": 44374111252242.305,
     "sats": 4437411125224230.5
   },
   "total_volume": {
     "btc": 3256044.7530229515,
     "eth": 48770411.553476766,
     "ltc": 1373660290.0568473,
     "bch": 501868840.22939765,
     "bnb": 321418275.69140154,
     "eos": 74520500033.16203,
     "xrp": 234755006226.98267,
     "xlm": 744214985959.9684,
     "link": 13722169821.654129,
     "dot": 9707621292.707819,
     "yfi": 10240278.399462424,
     "usd": 98303834550.92047,
     "aed": 361069984305.52924,
     "ars": 11634251544617.66,
     "aud": 139399261065.7599,
     "bdt": 8611408140657.679,
     "bhd": 37064477779.07888,
     "bmd": 98303834550.92047,
     "brl": 482229460389.54034,
     "cad": 126069752619.82782,
     "chf": 95538645988.8375,
     "clp": 82496577955132.34,
     "cny": 659943132490.6929,
     "czk": 2293762693110.444,
     "dkk": 691068289193.8763,
     "eur": 92855344520.93542,
     "gbp": 78693890723.19893,
     "hkd": 771484561402.242,
     "huf": 35696621798736.57,
     "idr": 1438593060393351.8,
     "ils": 332155385929.8948,
     "inr": 7611752416652.15,
     "jpy": 12537496296033.4,
     "krw": 124437512408613.86,
     "kwd": 30112922118.81067,
     "lkr": 35409574601847.78,
     "mmk": 182111375731971.84,
     "mxn": 1958892351877.9226,
     "myr": 432094504768.5713,
     "ngn": 40807887798777.97,
     "nok": 953973833785.8777,
     "nzd": 153841667222.64273,
     "php": 5134163715615.871,
     "pkr": 19444498474172.027,
     "pln": 432016746435.44055,
     "rub": 6107125623172.091,
     "sar": 368744466365.0869,
     "sek": 974594734248.1216,
     "sgd": 135656834084.4064,
     "thb": 3382423593652.8755,
     "try": 1559285593263.2427,
     "twd": 2920764112339.2905,
     "uah": 2905980296965.0107,
     "vef": 9843162953.583647,
     "vnd": 2274750731508295,
     "zar": 1559188763986.212,
     "xdr": 71694264487.8355,
     "xag": 4503669266.233902,
     "xau": 53361287.47093044,
     "bits": 3256044753022.9517,
     "sats": 325604475302295.1
   },
   "market_cap_percentage": {
     "btc": 42.91721110028466,
     "eth": 18.17528936049499,
     "usdt": 5.526539780655016,
     "usdc": 3.917610674514349,
     "bnb": 3.8375591871181296,
     "xrp": 1.5112219771766642,
     "busd": 1.3834930508386953,
     "ada": 1.3542390843712317,
     "sol": 1.3315436038208737,
     "doge": 0.8607926996613122
   },
   "market_cap_change_percentage_24h_usd": 2.87211433018377,
   "updated_at": 1652979316
 }
}
 
 
*/


struct GlobalData: Codable {
    let data: MarketDataModel?
}


struct MarketDataModel: Codable {
    let totalMarketCap, totalVolume, marketCapPercentage: [String: Double]
    let marketCapChangePercentage24HUsd: Double
    
    enum Codingkeys: String, CodingKey {
        case totalMarketCap = "total_market_cap"
        case totalVolume = "total_volume"
        case marketCapPercentage = "market_cap_percentage"
        case marketCapChangePercentage24HUsd = "market_cap_change_percentage_24h_usd"
    }
    
    var marketCap: String {
        
        if let item = totalMarketCap.first(where: { $0.key == "usd"}) {
            return "\(item.value)"
        }
        return ""
    }
    
    var volume: String {
        if let item = totalVolume.first(where: { $0.key == "usd"}) {
            return "\(item.value)"
        }
        return ""
    }
    
    var btcDominance: String {
        if let item = marketCapPercentage.first(where: { $0.key == "btc"}) {
            return item.value.asPercentString()
        }
        return ""
    }
}
